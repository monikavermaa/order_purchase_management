c
self.save
c
self.total_amount = price * quantity
c
n
c
@order.order_items
 @order.order_items.sum(:total_amount)
c
@order.order_items
@order
c
@order.order_items
@order
c
self.total_amount = price * quantity
quantity
price
c
 @order.order_items.sum(:total_amount)
 @order.order_items.sum(:total_amount) * 0.08
@order
c
@order.save
@order
c
@order.order_items
@order.save
@order.valid?
@order
c
@order.save
@order.order_items.save
@order.order_items
@order.errors
@order.save
c
n
@order
n
c
prefecture = PrefectureCode.find_by(name: @order.delivery_state)
c
@order.save
c
@order
c
prefecture = PrefectureCode.find_by(name: @order.delivery_state)
c
@order.total_amount = @order.order_items.sum { |item| item.price * item.quantity }
c
souko_zaiko = SoukoZaiko.find_by(sku_code: item.sku_code, prefecture_code_id: prefecture.id)
c
prefecture = PrefectureCode.find_by(name: @order.delivery_state)
c
souko_zaiko = SoukoZaiko.find_by(sku_code: item.sku_code, prefecture_code_id: prefecture.id)
c
@order.order_items.sum(:price)
@order.order_items
@order.order_items.sum(:total_amount
@order.tax
c
SoukoZaiko.find_by(sku_code: item.sku_code, prefecture_code_id: prefecture.id)
c
prefecture.ew_flag
c
@order.delivery_state
PrefectureCode.find_by(name: @order.delivery_state)
c
SoukoZaiko
prefecture_code
SoukoZaiko.find_by(sku_code: item.sku_code, prefecture_code: prefecture_code)
c
prefecture
c
 SoukoZaiko.find_by(sku_code: item.sku_code).warehouse_code
 SoukoZaiko.find_by(sku_code: item.sku_code)
 SoukoZaiko.find_by(sku_code: item.sku_code, warehouse_code: east_west_flag)
east_west_flag
item.sku_code
